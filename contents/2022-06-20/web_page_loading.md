---
date: '2022-06-20'
title: '웹 페이지 로드 과정 (네트워크)'
categories: ['Web']
summary: '웹 페이지 전체 로드 과정 중 서버에서 브라우저로 데이터를 보내는 과정에 대하여 알아보자'
thumbnail: './web.png'
---

웹 페이지를 로드과정에는 단계가 있다.

1. 서버와 연결하기 (DNS, TCP)
2. 서버에 요청하기 (HTTP)
3. 응답 파일 해석하기 (DOM, CSSOM, JavaScript, Render Tree)
4. 웹 페이지 그리기 (Reflow, Repaint, Composite)

이번 포스팅에서는 네트워크 부분을 다뤄보도록 하겠다.

### 서버와 연결하기

주소창에 입력된 주소로 어떻게 웹 서버를 찾을 수 있을까?  
인터넷에서 다른 컴퓨터를 찾을 땐 <b>IP (Internet Protocol)</b>이라는 통신 규칙을 사용한다.

**IP** : 인터넷 상에서 내 컴퓨터 위치를 나타낼 수 있는 통신 규칙 127.0.0.0 같이 숫자 형태  
**Domain** : 사용자가 기억하기 쉽도록 IP를 문자로 바꾼 것  
**Protocol** : 컴퓨터 또는 통신 장비 간 정보를 주고 방법을 정리한 하나의 규칙

Domain은 <u>google.com</u> 같이 사용자가 기억하기 쉬운 문자로 이루어져 있는 주소를 말한다.  
이 Domain을 숫자로 이루어진 IP로 변환을 해야, 해당 서버의 실제 주소를 찾을 수 있다.  
이렇게 Domain을 IP로 변환하는 작업을 <b>Domain Name System</b>이라는 프로토콜을 활용하여 할 수 있다.

### 서버 주소 찾기 - DNS (Domain Name System)

DNS는 Domain을 IP 주소로 변환하는 작업을 수행한다.  
마치 ‘OO네 빵집’을 검색하면 숫자로 된 전화번호를 출력하는 인터넷의 전화번호부라고도 표현한다.  
그리고 이 DNS를 운영하는 서버를 <b>DNS 네임 서버</b>라고 하며 통신사(ISP), Google, cloudflare등 많은 회사들이 운영하며, 심지어 로컬(내 컴퓨터)에도 존재한다.  
해당 DNS의 IP를 찾기 위해서 컴퓨터의 운영체제가 DNS 네임 서버에 ‘질의’를 하고 DNS 네임 서버가 해당 DNS 도메인에 해당하는 IP를 반환하면, DNS 질의 과정은 끝난다.  
반환된 IP는 나중에 또 쓸 수 있도록, 로컬 DNS(내 컴퓨터) 캐시에 저장해둔다.  
그 다음 서버에 요청을 보내기 전 먼저 서버에 내 컴퓨터(송신자)의 존재를 알려주는 과정이 필요한데, 여기서 TCP가 사용된다.
TCP는 신뢰성이 떨어지는 UDP와 달리 데이터를 전송할 때 어떻게 서버와 연결하고 데이터를 안정적으로 잘 보낼지 고민하는 연결 지향 프로토콜이다.

통신하기 전에 연결 관계를 만들고 전송 방식을 제어하는데 초점이 맞춰줘 있는데 안정성과 신뢰성을 보장하기 위해 서버와 처음 접촉할 때 <b>3-way Handshake</b>라는 기법으로 데이터가 확실히 도착하도록 준비한다. 또한 데이터가 잘못 갔을 경우에도 이걸 캐치해서 다시 보내는 재전송도 수행한다.

<p align="center"><img src='/images/Web/server_data.png' width='100%' alt='server data' /></p>

송신자 측은 데이터를 보내기 전, 먼저 서버에게 보내도 되냐는 요청을 보내며 서버가 요청을 수락하면 데이터를 보내고, 또 데이터가 잘 도착했는지 서버에게 추가적인 확인도 받는다.  
만약 데이터가 유실되어 서버에게 데이터 도착 확인이 오지 않는다면, 송신자는 데이터를 다시 보내게 된다.  
이렇게 TCP를 사용해서 해당 웹 서버랑 소통 준비를 하고, 안정적으로 연결한다.

### 2. 서버에 요청하기

이제 연결도 마쳤으니, 웹 페이지 파일을 달라고 요청할 차례다.  
컴퓨터 간 데이터를 주고받을 때 HTTP, FTP 등 많은 프로토콜을 사용할 수 있다.  
위에서 TCP/IP 모델을 살펴봤듯이 이 프로토콜들은 <b>응용 계층</b>에 해당된다.  
이것은 사용자의 브라우저, 즉 어플리케이션 단에서 사용하는 프로토콜이다.  
응용 계층 프로토콜에서 만든 데이터가 <b>전송 계층 → 인터넷 계층 → 인터페이스 계층</b>으로 전달되어 정보가 추가되고, 상대 컴퓨터에게 보내는 방식이다.  
웹 페이지의 가장 중요한 구성 요소인 HTML 파일을 해당 웹 서버에 요청할 때 가장 특화된 프로토콜이 바로 HTTP이다. 주소창에서 흔하게 볼 수 있는 <u>http://xxx.xxx</u>의 http가 이 프로토콜을 뜻한다.

### HTTP (Hyper Text Transfer Protocol)

Hyper Text를 전송하기 위한 프로토콜이다. 여기서 Hyper Text는 웹 페이지를 구성하는 언어인 HTML을 의미한다.  
송신자가 <b>요청(request)</b>를 보내면, 수신자가 <b>응답(response)</b>하는 통신 구조를 가지고 있는데, 이 하나의 사이클을 <b>HTTP 트랜잭션</b>이라고 부른다.
또한, HTTP는 수신자가 응답하면 더 이상 HTTP 연결을 유지하지 않고 끊어버리기 때문에 <b>비연결성 프로토콜</b>이라고도 한다.  
웹페이지 https://google.com을 만들기 위해, google 웹 서버에 HTML 파일을 HTTP 프로토콜로 요청한다. google 웹 서버가 HTML 파일을 응답해 주면, 길고 긴 네트워크 통신과정이 끝나게 된다.

<br/>
<p align="center"><img src='/images/Web/network_path.png' width='70%' alt='network path' /></p>
<br/>

지금까지 네트워크 통신 과정에서 브라우저가 웹 서버를 어떻게 찾고, 연결하고 요청하는지 살펴보았다.  
사용자가 URL을 입력하면 DNS로 웹 서버의 IP를 찾고 TCP로 연결하는 과정을 거쳤으며, 그 후 브라우저가 웹 서버에게 HTTP 요청을 하여 HTML 파일을 받아왔다.  
이렇게 받은 HTML 파일을 브라우저에서 어떻게 처리할지 다음 시간에 알아보겠다.

### reference

[IMQA 웹 페이지 로딩 과정 이해하기](https://blog.imqa.io/webpage_loading_process/)
