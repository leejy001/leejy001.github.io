{
    "componentChunkName": "component---src-templates-post-template-tsx",
    "path": "/2022-03-02/throttle_debouncing/",
    "result": {"data":{"allMarkdownRemark":{"edges":[{"node":{"html":"<p>자바스크립트 최적화 이야기</p>\n<h3>Throttling, Debouncing</h3>\n<p>보통 자바스크립트의 프로그래밍 기법이라고 하며 둘 다 디바이스(일반적으로 CPU)의 무리를 주지 않기 위해 사용되곤 한다. 용어에 대해서 잠깐 정리하고 넘어가자\r\n<br/><br/>\r\n<b>쓰로틀링(throttling)</b>: 마지막 함수가 호출된 후 일정 시간이 지나기 전에 다시 호출되지 않도록 하는 프로그래밍 기법<br>\n보통 throttle은 압력 조절이라는 뜻을 가지고 있다. 파이프라인을 통해 이벤트라는 연료를 이동시키는 중이라고 생각을 해보자, 요청 혹은 이벤트가 의도한 바보다 너무 과도하게 발생한다면 일정하게 delay를 주고 delay 동안 파이프라인을 잠가버리는 것이다. 그 기간동안 발생한 이벤트, 요청, 함수 등은 무시된다.\r\n<br/><br/>\r\n<b>디바운싱(debouncing)</b>: 연이어 호출되는 함수들 중 마지막 함수(또는 제일 처음)만 호출하도록 하는 프로그래밍 기법<br>\n전자 쪽에서 bouncing이란 스위치들이 접점에서 떨어지거나 붙는 지점에 물리적으로 미세하게 여러번의 on/off가 발생하게 되는 현상이다. 이는 의도한 바가 아니니 사전에 방지해주는 것이 옳다.<br>\n이런 불필요한 현상을 방지하는 의미로 debouncing이라고 표현하며 여러 이벤트가 발생하면 일정 그룹으로 묶어 하나로 처리한다는 의미를 가지고 있다.</p>\n<p>디바운싱은 검색어 입력 시, 쓰로틀링은 스크롤에서 많이 사용하는데 코드를 보자</p>\n<h3>디바운싱</h3>\n<p>다음 코드를 이용해서 검색어를 입력해본다.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token operator\">&lt;</span>input id<span class=\"token operator\">=</span><span class=\"token string\">\"input\"</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span>\r\n\r\n<span class=\"token operator\">&lt;</span>script<span class=\"token operator\">></span>\r\n  document<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"#input\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"input\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"여기에 검색 결과 요청\"</span><span class=\"token punctuation\">,</span> e<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>script<span class=\"token operator\">></span></code></pre></div>\n<p>검색어를 입력하자마자 엔터 없이도 결과가 바로바로 나와야 하기 때문에 항상 input 이벤트에 대기하고 있다.<br>\n만약 <b>'안녕'</b>이라는 단어를 입력해보자 <b>ㅇ, 아, 안, 안ㄴ, 안녀, 안녕</b> 순으로 입력이 진행 될때마다 검색 결과 요청이 실행 되며, 유료 api를 사용한다면 글자를 한 글자씩 입력받을 때마다 쿼리가 날아가면 비용적 손해가 생길 수 있다.\r\n<br/><br/>\r\n다음은 디바운싱으로 검색어를 구현해봤다.<br>\ninput 이벤트 발생 시마다 200ms 씩 타이머를 설정해준다. 200ms 동안 입력이 없다면 입력이 끝난 것으로 판단하고, 200ms 이전에 타자 입력이 발생하면 이전 타이머는 취소하고 새로운 타이머를 설정한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token operator\">&lt;</span>input id<span class=\"token operator\">=</span><span class=\"token string\">\"input\"</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span>\r\n\r\n<span class=\"token operator\">&lt;</span>script<span class=\"token operator\">></span>\r\n  <span class=\"token keyword\">let</span> timer<span class=\"token punctuation\">;</span>\r\n\r\n  document<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"#input\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"input\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>timer<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n      <span class=\"token function\">clearTimeout</span><span class=\"token punctuation\">(</span>timer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n    timer <span class=\"token operator\">=</span> <span class=\"token function\">setTimeout</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n      console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"여기에 ajax 요청\"</span><span class=\"token punctuation\">,</span> e<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token number\">200</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>script<span class=\"token operator\">></span></code></pre></div>\n<p>검색어를 중간에 끊어서 입력하지 않는 한 여러번 호출이 되지 않는다. 이게 바로 디바운싱이다.</p>\n<h3>쓰로틀링</h3>\n<p>보통 성능 문제 때문에 많이 사용한다. (특성 자체가 실행 횟수에 제한을 건다.)<br>\n스크롤을 올리거나 내릴 때 scroll 이벤트가 매우 많이 발생한다.<br>\nscroll 이벤트가 발생할 때 뭔가 복잡한 작업을 설정한다면 (예를 들면 무한 스크롤의 경우) 매우 빈번하게 실행되기에 오류가 생길 수 도 있다.</p>\n<p>아래 코드는 쓰로틀링을 걸어주기 전의 코드다.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token operator\">&lt;</span>div<span class=\"token operator\">></span>\r\n    <span class=\"token operator\">&lt;</span>div style<span class=\"token operator\">=</span><span class=\"token string\">\"display: flex; flex-direction: column; position: fixed;\"</span><span class=\"token operator\">></span>\r\n        <span class=\"token operator\">&lt;</span>h3<span class=\"token operator\">></span>throttle 처리전<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>h3<span class=\"token operator\">></span>\r\n        <span class=\"token operator\">&lt;</span>div<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>label<span class=\"token operator\">></span>이벤트 발생 <span class=\"token operator\">:</span> <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>label<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>span id<span class=\"token operator\">=</span><span class=\"token string\">\"count\"</span><span class=\"token operator\">></span><span class=\"token number\">0</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>span<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\r\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\r\n    <span class=\"token operator\">&lt;</span>div style<span class=\"token operator\">=</span><span class=\"token string\">\"background-color: aquamarine; height: 500px;\"</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\r\n    <span class=\"token operator\">&lt;</span>div style<span class=\"token operator\">=</span><span class=\"token string\">\"background-color: lightblue; height: 500px;\"</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\r\n    <span class=\"token operator\">&lt;</span>div style<span class=\"token operator\">=</span><span class=\"token string\">\"background-color: lightcoral; height: 500px;\"</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\r\n    <span class=\"token operator\">&lt;</span>div style<span class=\"token operator\">=</span><span class=\"token string\">\"background-color: lightsalmon; height: 500px;\"</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\r\n    <span class=\"token operator\">&lt;</span>div style<span class=\"token operator\">=</span><span class=\"token string\">\"background-color: lemonchiffon; height: 500px;\"</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\r\n    <span class=\"token operator\">&lt;</span>div style<span class=\"token operator\">=</span><span class=\"token string\">\"background-color: lightskyblue; height: 500px;\"</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\r\n    <span class=\"token operator\">&lt;</span>div style<span class=\"token operator\">=</span><span class=\"token string\">\"background-color: lightseagreen; height: 500px;\"</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\r\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\r\n\r\n<span class=\"token operator\">&lt;</span>script<span class=\"token operator\">></span>\r\n  window<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"scroll\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"스크롤 이벤트 발생!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">const</span> count <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"count\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    count<span class=\"token punctuation\">.</span>innerText <span class=\"token operator\">=</span> <span class=\"token function\">parseInt</span><span class=\"token punctuation\">(</span>count<span class=\"token punctuation\">.</span>innerText<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>script<span class=\"token operator\">></span></code></pre></div>\n<p>끝까지 화면을 스크롤 하니 마우스 스크롤은 5번만 했는데 이벤트를 59번이나 발생한다.<br>\n스크롤을 일정 부분 내릴때마다 api를 호출해야 하는 경우라면 수많은 api가 중복 호출될 위험이 있다.<br>\n이때 쓰로틀링을 걸어주는데 몇 초에 한번, 또는 몇 밀리 초에 한 번씩만 실행되게 제한을 두며\r\n타이머가 설정되어 있다면 아무 동작도 하지 않고, 타이머가 없다면 타이머를 설정한다.</p>\n<p>타이머는 일정 시간 후에 스스로 해제하고 요청을 날리게 된다.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token operator\">&lt;</span>div<span class=\"token operator\">></span>\r\n    <span class=\"token operator\">&lt;</span>div style<span class=\"token operator\">=</span><span class=\"token string\">\"display: flex; flex-direction: column; position: fixed;\"</span><span class=\"token operator\">></span>\r\n        <span class=\"token operator\">&lt;</span>h3<span class=\"token operator\">></span>throttle 처리후<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>h3<span class=\"token operator\">></span>\r\n        <span class=\"token operator\">&lt;</span>div<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>label<span class=\"token operator\">></span>이벤트 발생 <span class=\"token operator\">:</span> <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>label<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>span id<span class=\"token operator\">=</span><span class=\"token string\">\"count\"</span><span class=\"token operator\">></span><span class=\"token number\">0</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>span<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\r\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\r\n    <span class=\"token operator\">&lt;</span>div style<span class=\"token operator\">=</span><span class=\"token string\">\"background-color: aquamarine; height: 500px;\"</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\r\n    <span class=\"token operator\">&lt;</span>div style<span class=\"token operator\">=</span><span class=\"token string\">\"background-color: lightblue; height: 500px;\"</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\r\n    <span class=\"token operator\">&lt;</span>div style<span class=\"token operator\">=</span><span class=\"token string\">\"background-color: lightcoral; height: 500px;\"</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\r\n    <span class=\"token operator\">&lt;</span>div style<span class=\"token operator\">=</span><span class=\"token string\">\"background-color: lightsalmon; height: 500px;\"</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\r\n    <span class=\"token operator\">&lt;</span>div style<span class=\"token operator\">=</span><span class=\"token string\">\"background-color: lemonchiffon; height: 500px;\"</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\r\n    <span class=\"token operator\">&lt;</span>div style<span class=\"token operator\">=</span><span class=\"token string\">\"background-color: lightskyblue; height: 500px;\"</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\r\n    <span class=\"token operator\">&lt;</span>div style<span class=\"token operator\">=</span><span class=\"token string\">\"background-color: lightseagreen; height: 500px;\"</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\r\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\r\n\r\n<span class=\"token operator\">&lt;</span>script<span class=\"token operator\">></span>\r\n  <span class=\"token keyword\">let</span> timer<span class=\"token punctuation\">;</span>\r\n\r\n  window<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"scroll\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>timer<span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\r\n    timer <span class=\"token operator\">=</span> <span class=\"token function\">setTimeout</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n      console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"스크롤 이벤트 발생!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      <span class=\"token keyword\">const</span> count <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"count\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      count<span class=\"token punctuation\">.</span>innerText <span class=\"token operator\">=</span> <span class=\"token function\">parseInt</span><span class=\"token punctuation\">(</span>count<span class=\"token punctuation\">.</span>innerText<span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\r\n      timer <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token number\">800</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>script<span class=\"token operator\">></span></code></pre></div>\n<p>쓰로틀링을 적용하기 전과 달리 끝까지 스크롤 시 3번의 이벤트 호출이 전부였다. (어느정도 차이는 있다.)<br>\n자바스크립트는 이벤트 기반의 언어이며 브라우저 환경에서 렌더링은 성능을 크게 좌지우지 하기 때문에, 이런 쓰로틀링이나 디바운싱의 개념이 중요하게 여겨지는 것 같다.<br>\n최적화의 방법은 무궁무진하고 그 만큼 많은 생각을 해야하는 것 같다.</p>","frontmatter":{"title":"쓰로틀링과 디바운싱","summary":"자바스크립트의 프로그래밍 기법인 쓰로틀링과 디바운싱을 알아보자","date":"2022.03.02.","categories":["JavaScript","최적화"],"thumbnail":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","placeholder":{"fallback":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAYAAACQjC21AAAACXBIWXMAAA7DAAAOwwHHb6hkAAABgElEQVQ4y+2UzyvDYRzH/QOWE6VY+ZGI0jdDSK2lOLDLDqjV2C+z+TUnlxHhoOSwkprbSi5OKw4OO7hSko0trclwUOIg8eWl72Pf2kG21W4cPn36PM/neT/v9/v59BRx6aAw4YSohaI/DPh5YRf5I2pHjtpF/R6x8X5uE1ndV3NODD+U5oQLkq7vtZQH7ifg1gOx38B+AFSYcT1OaKuX4JoekuMsz+jolMqY90iCaU4M1YbXMyvcefCONDE2VM9BoI+qimLOQiaMBi37gT64cSNH7HxmYyjYKTIfp5lzNjNpbuTqcJAarQarqY7t5W6eTywQd2ZnKKel7vl7SIaH8fs6MRtrhWdHOwPsrBtoqC5hcapFeJn5QD8CvinePEwJqe3NpejbylmdbSUc7Ke6UiM87ZDKWFIA73IAFJsxBy+no6x4dfjcEk/HFkiMsbthEJI3F7ryGxvRFHcKBiJUr1Lu/Mcm82YxyGlJSsjpOq/BVg+rzZkH1Do72P9vU0jAL+WuodgKRyMEAAAAAElFTkSuQmCC"},"images":{"fallback":{"src":"/static/ff8baacb3b7e020448d56932a93a427d/9b9a6/javascript_thumbnail.png","srcSet":"/static/ff8baacb3b7e020448d56932a93a427d/b78f2/javascript_thumbnail.png 112w,\n/static/ff8baacb3b7e020448d56932a93a427d/022a4/javascript_thumbnail.png 223w,\n/static/ff8baacb3b7e020448d56932a93a427d/9b9a6/javascript_thumbnail.png 446w","sizes":"(min-width: 446px) 446px, 100vw"},"sources":[{"srcSet":"/static/ff8baacb3b7e020448d56932a93a427d/5b8e6/javascript_thumbnail.webp 112w,\n/static/ff8baacb3b7e020448d56932a93a427d/cd3d4/javascript_thumbnail.webp 223w,\n/static/ff8baacb3b7e020448d56932a93a427d/48be0/javascript_thumbnail.webp 446w","type":"image/webp","sizes":"(min-width: 446px) 446px, 100vw"}]},"width":446,"height":414.99999999999994}},"publicURL":"/static/ff8baacb3b7e020448d56932a93a427d/javascript_thumbnail.png"}}}}]}},"pageContext":{"slug":"/2022-03-02/throttle_debouncing/"}},
    "staticQueryHashes": []}